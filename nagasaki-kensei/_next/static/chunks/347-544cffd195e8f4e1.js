(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[347],{6026:(e,t,l)=>{"use strict";l.d(t,{ClientContainer:()=>en});var r=l(95155);let n=()=>(0,r.jsxs)("svg",{width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg",children:[(0,r.jsx)("title",{children:"All View"}),(0,r.jsx)("path",{d:"M3 11C4.10457 11 5 10.1046 5 9C5 7.89543 4.10457 7 3 7C1.89543 7 1 7.89543 1 9C1 10.1046 1.89543 11 3 11Z",fill:"currentColor"}),(0,r.jsx)("path",{d:"M9 5C10.1046 5 11 4.10457 11 3C11 1.89543 10.1046 1 9 1C7.89543 1 7 1.89543 7 3C7 4.10457 7.89543 5 9 5Z",fill:"currentColor"}),(0,r.jsx)("path",{d:"M15 11C16.1046 11 17 10.1046 17 9C17 7.89543 16.1046 7 15 7C13.8954 7 13 7.89543 13 9C13 10.1046 13.8954 11 15 11Z",fill:"currentColor"}),(0,r.jsx)("path",{d:"M21 5C22.1046 5 23 4.10457 23 3C23 1.89543 22.1046 1 21 1C19.8954 1 19 1.89543 19 3C19 4.10457 19.8954 5 21 5Z",fill:"currentColor"}),(0,r.jsx)("path",{d:"M3 23C4.10457 23 5 22.1046 5 21C5 19.8954 4.10457 19 3 19C1.89543 19 1 19.8954 1 21C1 22.1046 1.89543 23 3 23Z",fill:"currentColor"}),(0,r.jsx)("path",{d:"M9 17C10.1046 17 11 16.1046 11 15C11 13.8954 10.1046 13 9 13C7.89543 13 7 13.8954 7 15C7 16.1046 7.89543 17 9 17Z",fill:"currentColor"}),(0,r.jsx)("path",{d:"M15 23C16.1046 23 17 22.1046 17 21C17 19.8954 16.1046 19 15 19C13.8954 19 13 19.8954 13 21C13 22.1046 13.8954 23 15 23Z",fill:"currentColor"}),(0,r.jsx)("path",{d:"M21 17C22.1046 17 23 16.1046 23 15C23 13.8954 22.1046 13 21 13C19.8954 13 19 13.8954 19 15C19 16.1046 19.8954 17 21 17Z",fill:"currentColor"})]}),i=()=>(0,r.jsxs)("svg",{width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg",children:[(0,r.jsx)("title",{children:"Dense View"}),(0,r.jsx)("path",{d:"M3.5 11C4.88071 11 6 9.88071 6 8.5C6 7.11929 4.88071 6 3.5 6C2.11929 6 1 7.11929 1 8.5C1 9.88071 2.11929 11 3.5 11Z",fill:"currentColor"}),(0,r.jsx)("path",{d:"M20.5 6C21.8807 6 23 4.88071 23 3.5C23 2.11929 21.8807 1 20.5 1C19.1193 1 18 2.11929 18 3.5C18 4.88071 19.1193 6 20.5 6Z",fill:"currentColor"}),(0,r.jsx)("path",{d:"M14.5 23C15.8807 23 17 21.8807 17 20.5C17 19.1193 15.8807 18 14.5 18C13.1193 18 12 19.1193 12 20.5C12 21.8807 13.1193 23 14.5 23Z",fill:"currentColor"})]}),s=()=>(0,r.jsxs)("svg",{width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg",children:[(0,r.jsx)("title",{children:"Hierarchy View"}),(0,r.jsx)("rect",{x:"7",y:"12",width:"15",height:"10",rx:"2",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"}),(0,r.jsx)("rect",{x:"2",y:"2",width:"10",height:"10",rx:"2",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"}),(0,r.jsx)("rect",{x:"12",y:"2",width:"7",height:"10",rx:"2",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"})]});var a=l(82180),o=l(77535),c=l(92091),d=l(99347),u=l(22064),h=l(76150),x=l(54921),m=l(23107),f=l(73060),g=l(20128);let b=(e,t,l)=>(0,r.jsxs)(o.B,{direction:["column",null,"row"],gap:2,alignItems:"center",justifyContent:"center",px:4,py:2,position:"absolute",top:0,left:0,right:0,bottom:0,color:"gray.500",children:[(0,r.jsx)(c.Icon,{as:e}),(0,r.jsx)(d.Box,{fontSize:["14px",null,"16px"],fontWeight:l?"bold":"normal",lineHeight:"1",textWrap:"nowrap",children:t})]});function p(e){let{selected:t,onChange:l,onClickDensitySetting:o,onClickFullscreen:p,isDenseGroupEnabled:j,onClickAttentionFilter:v,isAttentionFilterEnabled:y,showAttentionFilterBadge:C,attentionFilterBadgeCount:k}=e,w=[{value:"scatterAll",label:b(n,"全体","scatterAll"===t),isDisabled:!1},{value:"scatterDensity",label:b(i,"濃い意見","scatterDensity"===t),isDisabled:!j,tooltip:j?void 0:"この設定条件では抽出できませんでした"},{value:"treemap",label:b(s,"階層","treemap"===t),isDisabled:!1}];return(0,r.jsx)(d.Box,{maxW:"1200px",mx:"auto",mb:2,children:(0,r.jsxs)(d.Box,{display:"grid",gridTemplateColumns:["1fr",null,"1fr auto"],gap:"3",children:[(0,r.jsxs)(u.V_,{value:t,onChange:e=>{l(e.target.value)},size:"md",justifySelf:["center",null,"left","center"],ml:[0,null,null,"104px"],w:["100%",null,"auto"],h:["80px",null,"56px"],children:[(0,r.jsx)(u.Wn,{bg:"white",border:"1px solid #E4E4E7",boxShadow:"0 4px 6px 0 rgba(0, 0, 0, 0.1)"}),(0,r.jsx)(u.X8,{items:w,w:["calc(100% / 3)",null,"162px"],h:"100%",cursor:"pointer"})]}),(0,r.jsxs)(h.HStack,{gap:1,justifySelf:["end"],alignSelf:"center",children:[y&&v&&(0,r.jsx)(a.m,{content:"フィルタ",openDelay:0,closeDelay:0,children:(0,r.jsx)(x.Button,{onClick:v,variant:"outline",h:"50px",children:(0,r.jsxs)(d.Box,{display:"flex",alignItems:"center",gap:1,children:[(0,r.jsx)(c.Icon,{children:(0,r.jsx)(m.A,{size:16})}),C&&(0,r.jsx)(d.Box,{as:"span",fontSize:"xs",bg:"cyan.500",color:"white",p:"1",borderRadius:"md",minW:"5",children:k})]})})}),(0,r.jsx)(a.m,{content:"表示設定",openDelay:0,closeDelay:0,children:(0,r.jsx)(x.Button,{onClick:o,variant:"outline",h:"50px",w:"50px",p:0,children:(0,r.jsx)(c.Icon,{as:f.A})})}),(0,r.jsx)(a.m,{content:"全画面表示",openDelay:0,closeDelay:0,children:(0,r.jsx)(x.Button,{onClick:p,variant:"outline",h:"50px",w:"50px",p:0,children:(0,r.jsx)(c.Icon,{as:g.A})})})]})]})})}var j=l(1178),v=l(12115);let y=v.forwardRef(function(e,t){let{icon:l,children:n,inputProps:i,rootRef:s,...a}=e;return(0,r.jsxs)(j.y8,{ref:s,...a,children:[(0,r.jsx)(j.Ks,{ref:t,...i}),(0,r.jsx)(j.v7,{children:l||(0,r.jsx)(j.P7,{})}),null!=n&&(0,r.jsx)(j.Sb,{children:n})]})});var C=l(54679),k=l(48409),w=l(55756),S=l(45308),_=l(56579),B=l(35761),z=l(30798);let A=v.memo(function(e){let{attrName:t,value:l,checked:n,count:i,onChange:s}=e;return(0,r.jsxs)(d.Box,{p:1,px:2,borderWidth:1,borderRadius:"md",bg:n?"blue.50":"transparent",_hover:{bg:"gray.50"},cursor:"pointer",onClick:()=>s(t,l),children:[(0,r.jsx)(y,{checked:n,onChange:()=>s(t,l),children:l||"(空)"}),(0,r.jsx)(k.Text,{as:"span",fontSize:"xs",ml:1,color:"gray.500",children:i})]})});function N(e){let{attributes:t=[],onClose:l,onApplyFilters:n,initialFilters:i={},initialNumericRanges:s={},initialEnabledRanges:a={},initialIncludeEmptyValues:o={},initialTextSearch:c=""}=e;(0,v.useMemo)(()=>t.map(e=>e.name),[t]);let[u,h]=(0,v.useState)(i),[m,f]=(0,v.useState)(Object.keys(s).length>0?s:Object.fromEntries(t.filter(e=>"numeric"===e.type&&e.numericRange).map(e=>[e.name,e.numericRange]))),[g,b]=(0,v.useState)(a),[p,j]=(0,v.useState)(o),[N,D]=(0,v.useState)(c),L=(0,v.useCallback)((e,t)=>{h(l=>{var r;let n=null!=(r=l[e])?r:[],i=n.includes(t)?n.filter(e=>e!==t):[...n,t],s={...l};return 0===i.length?delete s[e]:s[e]=i,s})},[]),E=(0,v.useCallback)((e,l,r)=>{f(n=>{var i,s,a;let[o,c]=null!=(a=null!=(s=n[e])?s:null==(i=t.find(t=>t.name===e))?void 0:i.numericRange)?a:[0,0],d=0===l?[Math.min(r,c),c]:[o,Math.max(r,o)];return{...n,[e]:d}})},[t]),M=(0,v.useCallback)(e=>{b(t=>({...t,[e]:!t[e]}))},[]),R=(0,v.useCallback)(e=>{j(t=>({...t,[e]:!t[e]}))},[]),T=(0,v.useCallback)(()=>{h({}),f(Object.fromEntries(t.filter(e=>"numeric"===e.type&&e.numericRange).map(e=>[e.name,e.numericRange]))),b({}),j({}),D("")},[t]),W=(0,v.useCallback)(()=>{n(u,m,p,g,N),l()},[u,m,p,g,N,n,l]);return(0,r.jsx)(C.Dz,{lazyMount:!0,open:!0,onOpenChange:l,children:(0,r.jsxs)(C.Cf,{width:"80vw",maxWidth:"1200px",children:[(0,r.jsx)(C.R4,{children:(0,r.jsxs)(d.Box,{mb:6,mt:4,children:[(0,r.jsx)(w.Heading,{as:"h3",size:"md",mb:2,children:"フィルタ"}),(0,r.jsx)(k.Text,{fontSize:"sm",mb:5,color:"gray.600",children:"表示する意見グループを絞り込みます。フィルタ間はAND結合され、フィルタ内の条件はOR結合されます。"}),(0,r.jsxs)(d.Box,{mb:6,borderWidth:1,borderRadius:"md",p:3,children:[(0,r.jsx)(w.Heading,{as:"h4",size:"sm",mb:2,children:"テキスト検索"}),(0,r.jsx)(S.p,{placeholder:"検索したいテキストを入力してください。入力されたテキストが含まれる意見のみ表示されます。",value:N,onChange:e=>D(e.target.value),mb:2})]}),0===t.length?(0,r.jsx)(k.Text,{fontSize:"sm",color:"gray.500",children:"利用できる属性情報がありません。CSVファイルをアップロードする際に、属性列を選択してください。"}):t.map(e=>{var t,l,n,i,s,a,o,c,h;let x="numeric"===e.type;return(0,r.jsxs)(d.Box,{mb:4,children:[(0,r.jsxs)(_.Flex,{align:"center",mb:2,children:[(0,r.jsx)(w.Heading,{size:"sm",mb:0,mr:3,children:e.name}),x&&e.values.length>0&&(0,r.jsx)(y,{checked:!!g[e.name],onChange:()=>M(e.name),children:"フィルター有効化"})]}),x&&e.values.length>0?(0,r.jsx)(d.Box,{pl:2,pr:4,borderWidth:1,borderRadius:"md",p:2,children:(0,r.jsxs)(_.Flex,{align:"center",children:[(0,r.jsx)(y,{checked:!!p[e.name],onChange:()=>R(e.name),disabled:!g[e.name],mr:4,children:"空の値を含める"}),(0,r.jsxs)(k.Text,{fontSize:"xs",width:"60px",textAlign:"right",mr:2,children:["最小: ",null!=(s=null==(t=e.numericRange)?void 0:t[0])?s:"-"]}),(0,r.jsx)(S.p,{type:"number",value:null!=(a=null==(l=m[e.name])?void 0:l[0])?a:"",onChange:t=>E(e.name,0,Number(t.target.value)),size:"sm",width:"100px",disabled:!g[e.name]}),(0,r.jsx)(k.Text,{mx:2,children:"～"}),(0,r.jsx)(S.p,{type:"number",value:null!=(o=null==(n=m[e.name])?void 0:n[1])?o:"",onChange:t=>E(e.name,1,Number(t.target.value)),size:"sm",width:"100px",disabled:!g[e.name]}),(0,r.jsxs)(k.Text,{fontSize:"xs",width:"60px",textAlign:"left",ml:2,children:["最大: ",null!=(c=null==(i=e.numericRange)?void 0:i[1])?c:"-"]})]})}):(0,r.jsx)(d.Box,{pl:2,children:e.values.length>100?(0,r.jsx)(z.Y1,{height:300,itemCount:e.values.length,itemSize:40,width:"100%",itemData:{attrName:e.name,values:e.values,checkedList:null!=(h=u[e.name])?h:[],valueCounts:e.valueCounts,onChange:L},children:e=>{var t;let{index:l,style:n,data:i}=e,s=i.values[l];return(0,r.jsx)("div",{style:n,children:(0,r.jsx)(A,{attrName:i.attrName,value:s,checked:i.checkedList.includes(s),count:null!=(t=i.valueCounts[s])?t:0,onChange:i.onChange})},"".concat(i.attrName,"-").concat(s))}}):(0,r.jsx)(B.B,{style:{gap:"8px"},children:e.values.map(t=>{var l,n;return(0,r.jsx)(B.Q,{mb:2,mr:3,children:(0,r.jsx)(A,{attrName:e.name,value:t,checked:(null==(l=u[e.name])?void 0:l.includes(t))||!1,count:null!=(n=e.valueCounts[t])?n:0,onChange:L})},"".concat(e.name,"-").concat(t))})})})]},e.name)})]})}),(0,r.jsxs)(C.Es,{justifyContent:"space-between",children:[(0,r.jsx)(x.Button,{onClick:T,variant:"outline",size:"sm",children:"すべてクリア"}),(0,r.jsx)(x.Button,{onClick:W,colorScheme:"blue",children:"設定を適用"})]})]})})}var D=l(49622);function L(e){let{loaded:t,max:l,isVisualizing:n}=e;return n?(0,r.jsx)(D.wi,{value:null,size:"xl",mx:"auto",p:5,maxW:"800px",colorPalette:"cyan",children:(0,r.jsxs)(h.HStack,{gap:"5",children:[(0,r.jsx)(D.XL,{flex:"1",children:(0,r.jsx)(D.Fx,{})}),(0,r.jsx)(D.uW,{children:"Visualizing..."})]})}):(0,r.jsx)(D.wi,{value:t,max:l,size:"xl",mx:"auto",p:5,maxW:"800px",colorPalette:"cyan",children:(0,r.jsxs)(h.HStack,{gap:"5",children:[(0,r.jsx)(D.XL,{flex:"1",children:(0,r.jsx)(D.Fx,{})}),(0,r.jsxs)(D.eY,{children:[Math.floor(t/1024).toLocaleString()," KB / ",Math.floor(l/1024).toLocaleString()," KB"]})]})})}let E={moduleType:"locale",name:"ja",dictionary:{Autoscale:"自動スケーリング","Box Select":"ボックス選択","Click to enter Colorscale title":"クリックしてカラースケールのタイトルを入力","Click to enter Component A title":"クリックしてコンポーネントAのタイトルを入力","Click to enter Component B title":"クリックしてコンポーネントBのタイトルを入力","Click to enter Component C title":"クリックしてコンポーネントCのタイトルを入力","Click to enter Plot title":"クリックしてプロットのタイトルを入力","Click to enter X axis title":"クリックしてX軸のタイトルを入力","Click to enter Y axis title":"クリックしてY軸のタイトルを入力","Compare data on hover":"ホバーでデータを比較","Double-click on legend to isolate one trace":"凡例をダブルクリックすると1つのトレースだけを表示","Double-click to zoom back out":"ダブルクリックでズームアウト","Download plot as a png":"PNGとしてプロットをダウンロード","Download plot":"プロットをダウンロード","Edit in Chart Studio":"Chart Studioで編集","IE only supports svg.  Changing format to svg.":"IEはSVG形式のみ対応。SVGに変換します。","Lasso Select":"なげなわ選択","Orbital rotation":"軌道回転",Pan:"パン操作","Produced with Plotly.js":"Plotly.js により作成",Reset:"リセット","Reset axes":"軸をリセット","Reset camera to default":"カメラをデフォルト位置にリセット","Reset camera to last save":"カメラを最後の保存状態に戻す","Reset view":"ビューをリセット","Reset views":"ビューをリセット","Show closest data on hover":"ホバー時に最も近いデータを表示","Snapshot succeeded":"スナップショットに成功しました","Sorry, there was a problem downloading your snapshot!":"スナップショットのダウンロード中に問題が発生しました","Taking snapshot - this may take a few seconds":"スナップショットを作成中（数秒かかる場合があります）",Zoom:"ズーム","Zoom in":"拡大","Zoom out":"縮小","close:":"終値:",trace:"トレース:","lat:":"緯度:","lon:":"経度:","q1:":"第1四分位数:","q3:":"第3四分位数:","source:":"ソース:","target:":"ターゲット:","lower fence:":"下限フェンス:","upper fence:":"上限フェンス:","max:":"最大:","mean \xb1 σ:":"平均 \xb1 σ:","mean:":"平均:","median:":"中央値:","min:":"最小:","Turntable rotation":"ターンテーブル回転","Toggle Spike Lines":"スパイクラインの切り替え","open:":"始値:","high:":"高値:","low:":"安値:","Toggle show closest data on hover":"ホバー時の最も近いデータ表示を切り替え","incoming flow count:":"流入フロー数:","outgoing flow count:":"流出フロー数:","kde:":"カーネル密度推定:","Click to enter radial axis title":"クリックして放射軸のタイトルを入力","new text":"新しいテキスト"},format:{days:["日曜日","月曜日","火曜日","水曜日","木曜日","金曜日","土曜日"],shortDays:["日","月","火","水","木","金","土"],months:["1月","2月","3月","4月","5月","6月","7月","8月","9月","10月","11月","12月"],shortMonths:["1月","2月","3月","4月","5月","6月","7月","8月","9月","10月","11月","12月"],date:"%Y/%m/%d"}},M=(0,l(67909).default)(async()=>{let e=await Promise.all([l.e(122),l.e(709),l.e(478),l.e(761),l.e(726),l.e(921),l.e(21)]).then(l.t.bind(l,68021,23)),t=await Promise.all([l.e(122),l.e(709),l.e(478),l.e(761),l.e(726),l.e(921),l.e(456)]).then(l.t.bind(l,93075,23)),r=await Promise.all([l.e(122),l.e(709),l.e(478),l.e(761),l.e(742),l.e(178)]).then(l.t.bind(l,71178,23)),n=await Promise.all([l.e(122),l.e(709),l.e(478),l.e(761),l.e(742),l.e(352)]).then(l.t.bind(l,8352,23)),i=await Promise.all([l.e(122),l.e(709),l.e(478),l.e(608),l.e(761),l.e(726),l.e(471)]).then(l.t.bind(l,1471,23)),s=(await l.e(474).then(l.bind(l,49474))).default;return e.register([t,r,n,i]),e.register(E),s(e)},{loadableGenerated:{webpack:()=>[49474]},ssr:!1,loading:()=>(0,r.jsx)(L,{loaded:100,max:100,isVisualizing:!0})});function R(e){let{clusterList:t,argumentList:l,targetLevel:n,onHover:i,showClusterLabels:s,filteredArgumentIds:a,config:o}=e,c=t.filter(e=>e.level===n),u=["#7ac943","#3fa9f5","#ff7997","#e0dd02","#d6410f","#b39647","#7cccc3","#a147e6","#ff6b6b","#4ecdc4","#ffbe0b","#fb5607","#8338ec","#3a86ff","#ff006e","#8ac926","#1982c4","#6a4c93","#f72585","#7209b7","#00b4d8","#e76f51","#606c38","#9d4edd","#457b9d","#bc6c25","#2a9d8f","#e07a5f","#5e548e","#81b29a","#f4a261","#9b5de5","#f15bb5","#00bbf9","#98c1d9","#84a59d","#f28482","#00afb9","#cdb4db","#fcbf49"],h=c.reduce((e,t,l)=>(e[t.id]=u[l%u.length],e),{}),x=c.reduce((e,t,l)=>(e[t.id]=u[l%u.length]+Math.floor(204).toString(16).padStart(2,"0"),e),{}),m=e=>a?{matching:l.filter(t=>t.cluster_ids.includes(e.id)&&a.includes(t.arg_id)),notMatching:l.filter(t=>t.cluster_ids.includes(e.id)&&!a.includes(t.arg_id))}:{matching:l.filter(t=>t.cluster_ids.includes(e.id)),notMatching:[]},f=c.map(e=>{let t=l.filter(t=>t.cluster_ids.includes(e.id)),r=t.map(e=>e.x),n=t.map(e=>e.y),i=r.length>0?r.reduce((e,t)=>e+t,0)/r.length:0,s=n.length>0?n.reduce((e,t)=>e+t,0)/n.length:0,{matching:c,notMatching:d}=m(e),u=a&&(0===c.length||e.allFiltered),x=d.length>0||u?{x:d.length>0?d.map(e=>e.x):t.map(e=>e.x),y:d.length>0?d.map(e=>e.y):t.map(e=>e.y),mode:"markers",marker:{size:7,color:Array(d.length>0?d.length:t.length).fill("#cccccc"),opacity:Array(d.length>0?d.length:t.length).fill(.5)},text:Array(d.length>0?d.length:t.length).fill(""),type:"scattergl",hoverinfo:"skip",showlegend:!1,customdata:d.length>0?d.map(e=>({arg_id:e.arg_id,url:e.url})):t.map(e=>({arg_id:e.arg_id,url:e.url}))}:null,f=c.length>0?{x:c.map(e=>e.x),y:c.map(e=>e.y),mode:"markers",marker:{size:10,color:Array(c.length).fill(h[e.id]),opacity:Array(c.length).fill(1),line:(null==o?void 0:o.enable_source_link)?{width:2,color:"#ffffff"}:void 0},text:c.map(t=>{let l=t.argument.replace(/(.{30})/g,"$1<br />"),r=(null==o?void 0:o.enable_source_link)&&t.url?"<br><b>\uD83D\uDD17 クリックしてソースを見る</b>":"";return"<b>".concat(e.label,"</b><br>").concat(l).concat(r)}),type:"scattergl",hoverinfo:"text",hovertemplate:"%{text}<extra></extra>",hoverlabel:{align:"left",bgcolor:"white",bordercolor:h[e.id],font:{size:12,color:"#333"}},showlegend:!1,customdata:c.map(e=>({arg_id:e.arg_id,url:e.url}))}:null;return{cluster:e,notMatchingData:x,matchingData:f,centerX:i,centerY:s}}),g=f.flatMap(e=>{let t=[];if(e.notMatchingData&&t.push(e.notMatchingData),e.matchingData&&t.push(e.matchingData),!a){let r=l.filter(t=>t.cluster_ids.includes(e.cluster.id));r.length>0&&t.push({x:r.map(e=>e.x),y:r.map(e=>e.y),mode:"markers",marker:{size:7,color:h[e.cluster.id]},text:r.map(t=>"<b>".concat(e.cluster.label,"</b><br>").concat(t.argument.replace(/(.{30})/g,"$1<br />"))),type:"scattergl",hoverinfo:"text",hoverlabel:{align:"left",bgcolor:"white",bordercolor:h[e.cluster.id],font:{size:12,color:"#333"}},showlegend:!1,customdata:r.map(e=>({arg_id:e.arg_id,url:e.url}))})}return t}),b=s?f.map(e=>{let t=a&&(0===m(e.cluster).matching.length||e.cluster.allFiltered)?x[e.cluster.id].replace(/[0-9a-f]{2}$/i,"cc"):x[e.cluster.id];return{x:e.centerX,y:e.centerY,text:(e=>{let t="",l="",r=0;for(let n=0;n<e.length;n++){let i=e[n],s=(/[!-~]/.test(i)?.6:1)*14;(r+=s)>228?(t+="".concat(l,"<br>"),l=i,r=s):l+=i}return l&&(t+="".concat(l)),t})(e.cluster.label),showarrow:!1,font:{color:"white",size:14,weight:700},bgcolor:t,borderpad:10,width:228,align:"left"}}):[];return(0,r.jsx)(d.Box,{width:"100%",height:"100%",display:"flex",flexDirection:"column",children:(0,r.jsx)(d.Box,{position:"relative",flex:"1",children:(0,r.jsx)(M,{data:g,layout:{margin:{l:0,r:0,b:0,t:0},xaxis:{zeroline:!1,showticklabels:!1,showgrid:!1},yaxis:{zeroline:!1,showticklabels:!1,showgrid:!1},hovermode:"closest",dragmode:"pan",annotations:b,showlegend:!1},useResizeHandler:!0,style:{width:"100%",height:"100%",cursor:(null==o?void 0:o.enable_source_link)?"pointer":"default"},config:{responsive:!0,displayModeBar:"hover",scrollZoom:!0,locale:"ja"},onHover:i,onUpdate:e=>{try{for(let e of document.querySelectorAll("g.annotation")){let t=e.querySelector("rect.bg");t&&(t.setAttribute("rx","".concat(4,"px")),t.setAttribute("ry","".concat(4,"px")))}}catch(e){console.error("アノテーション要素の角丸化に失敗しました:",e)}!function(){let e=document.querySelector(".modebar-container");if(!e)return;let t=e.children[0],l=document.getElementById("fullScreenButtons");if(!t||!l)return;let r=t.getBoundingClientRect(),n=l.getBoundingClientRect();if(n.top>r.bottom||n.bottom<r.top||n.left>r.right||n.right<r.left)return;let i=n.bottom-r.top;e.style.top="".concat(Number.parseInt(e.style.top.slice(0,-2))+i+10,"px")}()},onClick:e=>{if(null==o?void 0:o.enable_source_link)try{var t;let r=null==(t=e.points)?void 0:t[0];if(null==r?void 0:r.customdata){let e=r.customdata;if(e.url)window.open(e.url,"_blank","noopener,noreferrer");else{let t=l.find(t=>t.arg_id===e.arg_id);(null==t?void 0:t.url)?window.open(t.url,"_blank","noopener,noreferrer"):console.log("No URL found for argument:",e.arg_id)}}else console.log("No customdata found in clicked point")}catch(e){console.error("Error in click handler:",e)}}})})})}function T(e){let{clusterList:t,argumentList:l,onHover:n,level:i,onTreeZoom:s,filteredArgumentIds:a}=e,o=!!a,c=l.map(e=>{var t;let l={level:3,id:(t=e).arg_id,label:t.argument,takeaway:"",value:1,parent:t.cluster_ids[2],density_rank_percentile:0};return a&&!a.includes(e.arg_id)?{...l,filtered:!0}:l}),d={};for(let e of t)d[e.id]=0;for(let e of l)if(!o||a.includes(e.arg_id))for(let t of e.cluster_ids)void 0!==d[t]&&d[t]++;let u=[{...t[0],parent:""},...t.slice(1),...c],h=u.map(e=>e.id),x=u.map(e=>e.id===i?e.label.replace(/(.{50})/g,"$1<br />"):e.label.replace(/(.{15})/g,"$1<br />")),m=u.map(e=>e.parent),f=u.map(e=>void 0!==d[e.id]?o?d[e.id]:e.value:+!e.filtered),g={type:"treemap",ids:h,labels:x,parents:m,values:f,customdata:u.map(e=>{let t=e.takeaway.replace(/(.{15})/g,"$1<br />");if(void 0!==d[e.id]&&o){let l=e.value,r=d[e.id];r<l&&(t="".concat(t,"<br><br>元の件数: ").concat(l,"<br>フィルター後: ").concat(r))}return e.filtered?"":t}),level:i,branchvalues:"total",marker:{colors:u.map(e=>e.filtered?"#cccccc":""),line:{width:1,color:"white"},opacity:u.map(e=>e.filtered?.5:1)},hoverinfo:"text",hovertemplate:"%{customdata}<extra></extra>",hoverlabel:{align:"left"},texttemplate:o?"%{label}<br>%{value:,}件 (フィルター後)<br>%{percentEntry:.2%}":"%{label}<br>%{value:,}件<br>%{percentEntry:.2%}",maxdepth:2,pathbar:{thickness:28}};return(0,r.jsx)(M,{data:[g],layout:{margin:{l:10,r:10,b:10,t:30},colorway:["#b3daa1","#f5c5d7","#d5e5f0","#fbecc0","#80b8ca","#dabeed","#fad1af","#fbb09d","#a6e3ae","#f1e4d6"]},useResizeHandler:!0,style:{width:"100%",height:"100%"},config:{responsive:!0,displayModeBar:!1,locale:"ja"},onUpdate:W,onUnhover:W,onHover:()=>{n&&n(),W()},onClick:e=>{var t;let l=e.points[0];s((null==(t=l.data.ids[l.pointNumber])?void 0:t.toString())||"0")}})}function W(){let e=document.querySelectorAll(".treemap > .slice > .surface"),t=H(e[e.length-1]);for(let l of(e.length>1&&I(e[0],t),document.querySelectorAll(".treemap > .pathbar > .surface")))I(l,t)}function H(e){var t;return(null==(t=e.computedStyleMap().get("fill"))?void 0:t.toString())||""}function I(e,t){var l;if(H(e)!==t)return;let r=t.replace(/rgb\((\d+), (\d+), (\d+)\)/,(e,t,l,r)=>"rgb(".concat(O(t),", ").concat(O(l),", ").concat(O(r),")")),n=(null==(l=e.attributes.getNamedItem("style"))?void 0:l.value.replace(t,r))||"";e.setAttribute("style",n)}function O(e){return Math.max(0,Number.parseInt(e)-30)}var P=l(29417),F=l(58579),Z=l(26466);function V(e){let{result:t,selectedChart:l,isFullscreen:n,onExitFullscreen:i,showClusterLabels:s,onToggleClusterLabels:o,treemapLevel:u,onTreeZoom:m,filterState:f}=e,g=(0,v.useMemo)(()=>{if(!f)return;let{attributeFilters:e,numericRanges:l,enabledRanges:r,includeEmptyValues:n,textSearch:i}=f;if(0!==Object.keys(e).length||0!==Object.keys(r).filter(e=>r[e]).length||""!==i.trim())return t.arguments.filter(t=>{if(""!==i.trim()){let e=i.trim().toLowerCase();if(!t.argument.toLowerCase().includes(e))return!1}if(t.attributes){for(let[l,r]of Object.entries(e)){var s;if(0===r.length)continue;let e=String(null!=(s=t.attributes[l])?s:"");if(!r.includes(e))return!1}for(let[e,i]of Object.entries(l)){if(!r[e])continue;let l=t.attributes[e];if(null==l||""===l){if(!n[e])return!1}else{let e=Number(l);if(Number.isNaN(e)||e<i[0]||e>i[1])return!1}}}else if(""===i.trim())return!1;return!0}).map(e=>e.arg_id)},[t.arguments,f]);return n?(0,r.jsx)(P.Dz,{size:"full",open:n,onOpenChange:i,children:(0,r.jsxs)(F.Z,{children:[(0,r.jsx)(P.Xi,{}),(0,r.jsx)(P.f5,{children:(0,r.jsx)(P.Cf,{children:(0,r.jsxs)(d.Box,{w:"100%",h:"100vh",display:"flex",flexDirection:"column",justifyContent:"center",alignItems:"center",bg:"#fff",children:[(0,r.jsx)(h.HStack,{id:"fullScreenButtons",position:"fixed",top:5,right:5,zIndex:1,children:(0,r.jsx)(a.m,{content:"全画面終了",openDelay:0,closeDelay:0,children:(0,r.jsx)(x.Button,{onClick:i,h:"50px",borderWidth:2,children:(0,r.jsx)(c.Icon,{children:(0,r.jsx)(Z.A,{})})})})}),("scatterAll"===l||"scatterDensity"===l)&&(0,r.jsx)(R,{clusterList:t.clusters,argumentList:t.arguments,targetLevel:"scatterAll"===l?1:Math.max(...t.clusters.map(e=>e.level)),onHover:()=>setTimeout(q,500),showClusterLabels:s,filteredArgumentIds:g,config:t.config}),"treemap"===l&&(0,r.jsx)(T,{clusterList:t.clusters,argumentList:t.arguments,onHover:q,level:u,onTreeZoom:m,filteredArgumentIds:g},u)]})})})]})}):(0,r.jsx)(d.Box,{mx:"auto",w:"100%",maxW:"1200px",mb:10,border:"1px solid #ccc",children:(0,r.jsxs)(d.Box,{h:"500px",mb:0,children:["treemap"===l&&(0,r.jsx)(T,{clusterList:t.clusters,argumentList:t.arguments,level:u,onTreeZoom:m,filteredArgumentIds:g},u),("scatterAll"===l||"scatterDensity"===l)&&(0,r.jsx)(R,{clusterList:t.clusters,argumentList:t.arguments,targetLevel:"scatterAll"===l?1:Math.max(...t.clusters.map(e=>e.level)),showClusterLabels:s,filteredArgumentIds:g,config:t.config})]})})}function q(){let e=document.querySelector(".hoverlayer"),t=document.getElementById("fullScreenButtons");if(!e||!t)return;let l=e.getBoundingClientRect(),r=t.getBoundingClientRect();if(r.top>l.bottom||r.bottom<l.top||r.left>l.right||r.right<l.left)return;let n=r.bottom-l.top,i=e.querySelector(".hovertext");if(!i)return;let s=i.getAttribute("transform");if(!s)return;let a="".concat(s.split(",")[0],",").concat((Number(s.split(",")[1].slice(0,-1))+n).toString(),")");i.setAttribute("transform",a);let o=i.querySelector("path");if(!o)return;let c=o.getAttribute("d");if(!c)return;let d=c.match(/[Ll]/g);if(!d)return;let u=d[0],h="".concat(c.split(",")[0],",").concat((Number(c.split(",")[1].split(u)[0])-n).toString()).concat(u).concat(c.split(u)[1]);o.setAttribute("d",h)}var X=l(57465),$=l(62447);function K(e){let{cluster:t}=e;return(0,r.jsxs)(d.Box,{mx:"auto",maxW:"750px",mb:12,children:[(0,r.jsxs)(d.Box,{mb:2,children:[(0,r.jsx)(X.N,{id:t.label,href:"#".concat(t.label),className:"headingColor",position:"relative",_hover:{"&:before":{content:'"#"',fontSize:"2xl",position:"absolute",left:"-1.4rem"}},children:(0,r.jsx)(w.Heading,{fontSize:"2xl",mb:0,children:t.label})}),(0,r.jsxs)(k.Text,{fontWeight:"bold",display:"flex",gap:1,mt:2,children:[(0,r.jsx)($.A,{size:20}),t.value.toLocaleString(),"件"]})]}),(0,r.jsx)(k.Text,{children:t.takeaway})]})}var U=l(23839),Y=l(40163);let G=v.forwardRef(function(e,t){var l;let{marks:n,label:i,showValue:s,...a}=e,o=null!=(l=e.defaultValue)?l:e.value,c=null==n?void 0:n.map(e=>"number"==typeof e?{value:e,label:void 0}:e),d=!!(null==c?void 0:c.some(e=>e.label));return(0,r.jsxs)(U.g1,{ref:t,thumbAlignment:"center",...a,children:[i&&!s&&(0,r.jsx)(U.KV,{children:i}),i&&s&&(0,r.jsxs)(h.HStack,{justify:"space-between",children:[(0,r.jsx)(U.KV,{children:i}),(0,r.jsx)(U.Ie,{})]}),(0,r.jsxs)(U.XB,{"data-has-mark-label":d||void 0,children:[(0,r.jsx)(U.hB,{children:(0,r.jsx)(U.tO,{})}),(0,r.jsx)(J,{value:o}),(0,r.jsx)(Q,{marks:c})]})]})});function J(e){let{value:t}=e;return(0,r.jsx)(Y.a,{each:t,children:(e,t)=>(0,r.jsx)(U.OQ,{index:t,children:(0,r.jsx)(U.Un,{})},t)})}let Q=v.forwardRef(function(e,t){let{marks:l}=e;return(null==l?void 0:l.length)?(0,r.jsx)(U.lq,{ref:t,children:l.map((e,t)=>{let l="number"==typeof e?e:e.value,n="number"==typeof e?void 0:e.label;return(0,r.jsxs)(U.mH,{value:l,children:[(0,r.jsx)(U.nI,{}),n]},l)})}):null});var ee=l(17274);let et=v.forwardRef(function(e,t){let{children:l,inputProps:n,rootRef:i,...s}=e;return(0,r.jsxs)(ee.lq,{ref:i,...s,children:[(0,r.jsx)(ee.tD,{ref:t,...n}),(0,r.jsx)(ee.oO,{children:(0,r.jsx)(ee.pD,{})}),null!=l&&(0,r.jsx)(ee.$X,{children:l})]})});var el=l(95937);function er(e){let{onClose:t,onChangeFilter:l,currentMaxDensity:n,currentMinValue:i,showClusterLabels:s=!1,onToggleClusterLabels:a}=e,[o,c]=(0,v.useState)(n),[u,m]=(0,v.useState)(i);return(0,r.jsx)(C.Dz,{lazyMount:!0,open:!0,onOpenChange:t,children:(0,r.jsxs)(C.Cf,{children:[(0,r.jsxs)(C.R4,{children:[(0,r.jsxs)(d.Box,{mb:6,mt:4,children:[(0,r.jsx)(k.Text,{fontWeight:"bold",mb:2,fontSize:"md",children:"表示設定"}),(0,r.jsx)(k.Text,{fontSize:"sm",mb:5,children:"「全体図」および「濃い意見グループ」に関する設定項目です。"}),(0,r.jsx)(d.Box,{p:2,borderRadius:"md",borderWidth:"1px",borderColor:"gray.200",mb:2,children:(0,r.jsxs)(h.HStack,{gap:2,alignItems:"center",children:[(0,r.jsx)(k.Text,{fontSize:"sm",children:"意見グループ名を表示"}),(0,r.jsx)(el.h,{}),(0,r.jsx)(et,{checked:s,onChange:()=>null==a?void 0:a(!s),size:"sm"})]})})]}),(0,r.jsx)(d.Box,{borderBottom:"1px solid",borderColor:"gray.200",mb:6}),(0,r.jsxs)(d.Box,{mb:4,children:[(0,r.jsx)(k.Text,{fontWeight:"bold",mb:2,fontSize:"md",children:"濃い意見グループ設定"}),(0,r.jsx)(k.Text,{fontSize:"sm",mb:5,children:"「濃い意見グループ」に関する設定項目です。"}),(0,r.jsx)(G,{label:"上位何％の意見グループを表示するか: ".concat(100*o,"%"),step:.1,min:.1,max:1,value:[o],onValueChange:e=>c(Number(e.value[0])),marks:[{value:.1,label:"10%"},{value:1,label:"100%"}]})]}),(0,r.jsx)(d.Box,{children:(0,r.jsx)(G,{label:"意見グループのサンプル数の最小数: ".concat(u),step:1,min:0,max:10,value:[u],onValueChange:e=>m(Number(e.value[0])),marks:[{value:0,label:"0"},{value:10,label:"10"}]})})]}),(0,r.jsxs)(C.Es,{justifyContent:"space-between",children:[(0,r.jsx)(el.h,{}),(0,r.jsx)(d.Box,{children:(0,r.jsx)(x.Button,{onClick:function(){l(o,u),t()},children:"設定を適用"})})]}),(0,r.jsx)(C.tK,{})]})})}function en(e){let{result:t}=e,[l,n]=(0,v.useState)(t),[i,s]=(0,v.useState)(!1),[a,o]=(0,v.useState)("scatterAll"),[c,d]=(0,v.useState)(.2),[u,h]=(0,v.useState)(5),[x,m]=(0,v.useState)(!1),[f,g]=(0,v.useState)(!0),[b,j]=(0,v.useState)(!0),[y,C]=(0,v.useState)("0"),k=(0,v.useMemo)(()=>t.arguments.map(e=>{if(e.attributes){let t={};for(let[l,r]of Object.entries(e.attributes))t[l]=null==r?"":String(r);return t}return{}}),[t]),[w,S]=(0,v.useState)([]);(0,v.useEffect)(()=>{if(!k||0===k.length)return void S([]);let e={};for(let l of k)for(let[r,n]of Object.entries(l)){var t;let l="string"==typeof n?n:String(null!=n?n:"");if(e[r]||(e[r]={valueSet:new Set,valueCounts:new Map,isNumeric:!0}),e[r].valueSet.add(l),e[r].valueCounts.set(l,(null!=(t=e[r].valueCounts.get(l))?t:0)+1),""!==l.trim()){let t=Number(l);Number.isNaN(t)?e[r].isNumeric=!1:e[r].isNumeric&&((void 0===e[r].min||t<e[r].min)&&(e[r].min=t),(void 0===e[r].max||t>e[r].max)&&(e[r].max=t))}}S(Object.entries(e).map(e=>{var t;let l,[r,n]=e,i=Array.from(n.valueSet).filter(e=>""!==e).sort(),s={};for(let e of i)s[e]=null!=(t=n.valueCounts.get(e))?t:0;return n.isNumeric&&i.length>0&&void 0!==n.min&&void 0!==n.max&&(l=[n.min,n.max]),{name:r,type:n.isNumeric?"numeric":"categorical",values:i,valueCounts:s,numericRange:l}}))},[k]);let[_,B]=(0,v.useState)({}),[z,A]=(0,v.useState)({}),[D,L]=(0,v.useState)({}),[E,M]=(0,v.useState)({}),[R,T]=(0,v.useState)(""),[W,H]=(0,v.useState)(!1);function I(e,l){let r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:_,i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:R;if(!t)return;let s=t.arguments,a=[],o=Object.keys(r).length>0||Object.keys(D).filter(e=>D[e]).length>0||""!==i.trim();o&&(a=(s=t.arguments.filter(e=>{if(""!==i.trim()){let t=i.trim().toLowerCase();if(!e.argument.toLowerCase().includes(t))return!1}if(e.attributes){let t=Object.entries(r).every(t=>{var l;let[r,n]=t,i=null==(l=e.attributes)?void 0:l[r];if(1===n.length&&n[0].startsWith("range:")){let[e,t,l]=n[0].split(":"),r=Number(t),s=Number(l),a=Number(i);return!Number.isNaN(a)&&a>=r&&a<=s}return n.includes(String(i))}),l=Object.entries(z).every(t=>{var l;let[r,n]=t;if(!D[r])return!0;let i=null==(l=e.attributes)?void 0:l[r];if(null==i||""===i)return E[r]||!1;let s=Number(i);return!Number.isNaN(s)&&s>=n[0]&&s<=n[1]});return t&&l}return""===i.trim()})).map(e=>e.arg_id));let c=new Set;for(let e of s)for(let t of e.cluster_ids)c.add(t);let{filtered:d}=ei(t.clusters||[],e,l),u=d.map(e=>o&&!c.has(e.id)?{...e,allFiltered:!0}:e);n({...t,clusters:u,arguments:t.arguments,filteredArgumentIds:o?a:void 0})}(0,v.useEffect)(()=>{let{filtered:e,isEmpty:l}=ei(t.clusters||[],c,u);g(!l)},[c,u,t.clusters]),(0,v.useMemo)(()=>0===Object.keys(_).length&&0===Object.keys(D).filter(e=>D[e]).length?k:k.filter(e=>{var t,l,r;for(let[l,r]of Object.entries(_))if(r.length>0&&void 0!==r[0]&&!r.includes(null!=(t=e[l])?t:""))return!1;for(let[t,n]of Object.entries(z))if(D[t]){let i=null!=(r=null==(l=e[t])?void 0:l.trim())?r:"";if(""===i){if(!E[t])return!1}else{let e=Number(i);if(Number.isNaN(e)||e<n[0]||e>n[1])return!1}}return!0}),[k,_,z,D,E]);let O=(0,v.useMemo)(()=>{let e=[];if("scatterDensity"===a){let t=Math.max(...l.clusters.map(e=>e.level));e=l.clusters.filter(e=>e.level===t)}else e=t.clusters.filter(e=>1===e.level);return e.sort((e,t)=>t.value-e.value)},[t.clusters,l.clusters,a]),P=e=>j(e);return(0,r.jsxs)("div",{children:[i&&(0,r.jsx)(er,{currentMaxDensity:c,currentMinValue:u,onClose:()=>s(!1),onChangeFilter:function(e,t){d(e),h(t),("scatterDensity"===a||"scatterAll"===a)&&I(e,t)},showClusterLabels:b,onToggleClusterLabels:P}),W&&(0,r.jsx)(N,{onClose:()=>H(!1),onApplyFilters:function(e,t,l,r,n){B(e),A(t),M(l),L(r),T(n),("scatterAll"===a||"scatterDensity"===a)&&I("scatterDensity"===a?c:1,"scatterDensity"===a?u:0,e,n)},attributes:w,initialFilters:_,initialNumericRanges:z,initialEnabledRanges:D,initialIncludeEmptyValues:E,initialTextSearch:R}),(0,r.jsx)(p,{selected:a,onChange:e=>{o(e),"scatterAll"===e&&I(1,0,_,R),"treemap"===e&&I(1,0,_,R),"scatterDensity"===e&&I(c,u,_,R)},onClickDensitySetting:()=>s(!0),onClickFullscreen:()=>m(!0),isDenseGroupEnabled:f,onClickAttentionFilter:()=>H(!0),isAttentionFilterEnabled:w.length>0,showAttentionFilterBadge:Object.keys(_).length>0||Object.keys(D).filter(e=>D[e]).length>0||""!==R.trim(),attentionFilterBadgeCount:new Set([...Object.keys(_),...Object.keys(D).filter(e=>D[e])]).size+ +(""!==R.trim())}),(0,r.jsx)(V,{result:l,selectedChart:a,isFullscreen:x,onExitFullscreen:()=>m(!1),showClusterLabels:b,onToggleClusterLabels:P,treemapLevel:y,onTreeZoom:e=>C(e),filterState:{attributeFilters:_,numericRanges:z,enabledRanges:D,includeEmptyValues:E,textSearch:R}}),O.map(e=>(0,r.jsx)(K,{cluster:e},e.id))]})}function ei(e,t,l){let r=e.reduce((e,t)=>Math.max(e,t.level),0),n=e.filter(e=>e.level===r).filter(e=>e.density_rank_percentile<=t).filter(e=>e.value>=l);return{filtered:[...e.filter(e=>e.level!==r),...n],isEmpty:0===n.length}}},24982:(e,t,l)=>{"use strict";l.d(t,{ReporterContent:()=>m});var r=l(95155),n=l(48409),i=l(56579),s=l(99347),a=l(55666),o=l(12115),c=l(28389),d=l(20559);function u(){return(0,r.jsxs)(n.Text,{textStyle:"body/md",color:"gray.500",children:["レポーター情報が未設定です。レポート作成者が",(0,r.jsx)(d.N,{href:"https://github.com/digitaldemocracy2030/kouchou-ai/blob/main/README.md#%E3%83%A1%E3%82%BF%E3%83%87%E3%83%BC%E3%82%BF%E3%83%95%E3%82%A1%E3%82%A4%E3%83%AB%E3%81%AE%E3%82%BB%E3%83%83%E3%83%88%E3%82%A2%E3%83%83%E3%83%97",target:"_blank",rel:"noopener noreferrer",children:"メタデータをセットアップ"}),"することでレポーター情報が表示されます。"]})}function h(e){let{setIsExpanded:t}=e;return(0,r.jsxs)(i.Flex,{textStyle:"body/md",display:"inline-flex",children:[(0,r.jsx)(n.Text,{mr:"0.4rem",children:"..."}),(0,r.jsx)(d.N,{onClick:()=>t(!0),children:"全文表示"})]})}function x(e){let{isDefault:t,message:l}=e,i=l.replace(/\n/g,""),s=i.length>55,[a,c]=(0,o.useState)(!s);return t?(0,r.jsx)(u,{}):(0,r.jsxs)(n.Text,{as:"div",textStyle:"body/md",color:"gray.600",textAlign:"left",whiteSpace:a?"pre-line":"normal",wordBreak:a?"normal":"break-all",children:[a?l:i.slice(0,55),!a&&(0,r.jsx)(h,{setIsExpanded:c})]})}function m(e){let{meta:t,children:l}=e;return(0,r.jsxs)(i.Flex,{flexDirection:"column",gap:"4",color:"gray.600",children:[(0,r.jsxs)(i.Flex,{flexDirection:{base:"column",md:"row"},alignItems:{base:"flex-start",md:"center"},children:[(0,r.jsx)(s.Box,{mb:{base:"4",md:"0"},mr:{base:"0",md:"4"},_empty:{display:"none"},children:l}),(0,r.jsxs)(i.Flex,{flexDirection:"column",justifyContent:"space-between",color:"gray.600",children:[(0,r.jsx)(n.Text,{textStyle:"body/sm",children:"レポーター"}),(0,r.jsx)(n.Text,{textStyle:"body/md/bold",children:t.reporter})]})]}),(0,r.jsx)(x,{isDefault:t.isDefault,message:t.message}),(0,r.jsxs)(i.Flex,{gap:"3",flexWrap:"wrap",w:"fit-content",_empty:{display:"none"},children:[!t.isDefault&&t.webLink&&(0,r.jsx)(c.Button,{variant:"tertiary",_icon:{width:"14px",height:"14px"},asChild:!0,children:(0,r.jsx)("a",{href:t.webLink,target:"_blank",rel:"noopener noreferrer",children:(0,r.jsxs)(i.Flex,{gap:"1",alignItems:"center",children:[(0,r.jsx)(a.A,{}),"ウェブページ"]})})}),!t.isDefault&&t.privacyLink&&(0,r.jsx)(c.Button,{variant:"tertiary",asChild:!0,children:(0,r.jsx)("a",{href:t.privacyLink,target:"_blank",rel:"noopener noreferrer",children:"プライバシーポリシー"})}),!t.isDefault&&t.termsLink&&(0,r.jsx)(c.Button,{variant:"tertiary",asChild:!0,children:(0,r.jsx)("a",{href:t.termsLink,target:"_blank",rel:"noopener noreferrer",children:"利用規約"})})]})]})}},49985:(e,t,l)=>{"use strict";l.d(t,{Analysis:()=>N});var r=l(95155),n=l(90908),i=l(61299),s=l(12115);let a=s.forwardRef(function(e,t){return(0,r.jsxs)(i.HV,{ref:t,children:[(0,r.jsx)(i.nn,{}),(0,r.jsx)(i.L2,{...e})]})}),o=i.sM,c=i.lx,d=i.Dd;i.L2;let u=i._A,h=i._U;var x=l(82180),m=l(83161),f=l(99347),g=l(68443),b=l(55756),p=l(76150),j=l(59964),v=l(92091),y=l(48409),C=l(56579),k=l(54921),w=l(90270),S=l(63250),_=l(63263),B=l(62447),z=l(37736),A=l(99156);function N(e){let{result:t}=e,[l,i]=(0,s.useState)(null),N=t.clusters.map(e=>e.level).reduce((e,t)=>(e[t]=(e[t]||0)+1,e),{}),{open:D,onToggle:L}=(0,m.j)();return(0,r.jsxs)(f.Box,{mx:"auto",maxW:"750px",mb:12,cursor:"default",children:[(0,r.jsx)(g.Separator,{mt:20,mb:12}),(0,r.jsx)(b.Heading,{textAlign:"center",fontSize:"xl",mb:5,children:"分析の概要"}),(0,r.jsxs)(p.HStack,{mb:5,justify:"center",children:[(0,r.jsx)(x.m,{content:"全てのコメントをAIで分析し、意見が含まれるコメントを抽出します。意見が含まれないコメントや、議題と関係のないコメントは除外されます。",openDelay:0,closeDelay:0,children:(0,r.jsxs)(j.VStack,{gap:0,w:"200px",children:[(0,r.jsx)(v.Icon,{mb:2,children:(0,r.jsx)(S.A,{size:"30px"})}),(0,r.jsx)(y.Text,{className:"headingColor",fontSize:"3xl",fontWeight:"bold",lineHeight:1,mb:1,children:t.comment_num.toLocaleString()}),(0,r.jsx)(y.Text,{fontSize:"xs",children:"コメント数"})]})}),(0,r.jsx)(_.A,{}),(0,r.jsx)(x.m,{content:"抽出したコメントをAIで分析し、様々な意見を抽出します。複数の意見が混ざったコメントなども適切に分離します。",openDelay:0,closeDelay:0,children:(0,r.jsxs)(j.VStack,{gap:0,w:"200px",children:[(0,r.jsx)(v.Icon,{mb:2,children:(0,r.jsx)(B.A,{size:"30px"})}),(0,r.jsx)(y.Text,{className:"headingColor",fontSize:"3xl",fontWeight:"bold",lineHeight:1,mb:1,children:t.arguments.length.toLocaleString()}),(0,r.jsx)(y.Text,{fontSize:"xs",children:"抽出した意見数"})]})}),(0,r.jsx)(_.A,{}),(0,r.jsx)(x.m,{content:"抽出した意見をAIで分析し、近しい意見を一つの意見グループに分類します。意見グループごとの意見を要約し、大量の意見を見える化します。",openDelay:0,closeDelay:0,children:(0,r.jsxs)(j.VStack,{gap:0,w:"200px",children:[(0,r.jsx)(v.Icon,{mb:2,children:(0,r.jsx)(z.A,{size:"30px"})}),(0,r.jsxs)(p.HStack,{gap:1,alignItems:"center",children:[(0,r.jsx)(y.Text,{className:"headingColor",fontSize:"3xl",fontWeight:"bold",lineHeight:1,mb:1,children:N["1"].toLocaleString()}),(0,r.jsx)(y.Text,{fontSize:"md",children:"→"}),(0,r.jsx)(y.Text,{className:"headingColor",fontSize:"3xl",fontWeight:"bold",lineHeight:1,mb:1,children:N["2"].toLocaleString()})]}),(0,r.jsx)(y.Text,{fontSize:"xs",children:"集約した意見グループ数"})]})})]}),(0,r.jsx)(y.Text,{mb:5,children:t.config.intro}),(0,r.jsxs)(f.Box,{children:[(0,r.jsxs)(C.Flex,{align:"center",mb:5,children:[(0,r.jsx)(b.Heading,{fontSize:"md",children:"分析手順"}),(0,r.jsx)(k.Button,{variant:"outline",size:"sm",ml:2,onClick:L,children:D?"非表示":"表示"})]}),(0,r.jsx)(w.C,{present:D,children:(0,r.jsx)(o,{size:"lg",children:t.config.plan.map(e=>(0,r.jsxs)(d,{children:[(0,r.jsx)(a,{children:(0,r.jsx)(A.A,{})}),"extraction"===e.step&&(0,r.jsxs)(c,{children:[(0,r.jsxs)(u,{fontWeight:"bold",children:["抽出 (",t.config.extraction.model,")"]}),(0,r.jsxs)(h,{children:["コメントデータから意見を抽出するステップです。",(0,r.jsx)("br",{})]}),(0,r.jsxs)(p.HStack,{children:[(0,r.jsx)(k.Button,{variant:"outline",size:"xs",onClick:()=>i({title:"抽出 - ".concat(e.step),body:t.config.extraction.source_code}),children:"ソースコード"}),(0,r.jsx)(k.Button,{variant:"outline",size:"xs",onClick:()=>i({title:"抽出 - ".concat(e.step),body:t.config.extraction.prompt}),children:"プロンプト"})]})]}),"embedding"===e.step&&(0,r.jsxs)(c,{children:[(0,r.jsxs)(u,{fontWeight:"bold",children:["埋め込み (",t.config.is_embedded_at_local?"sentence-transformers/paraphrase-multilingual-mpnet-base-v2":t.config.embedding.model,")"]}),(0,r.jsxs)(h,{children:["抽出された意見に対して埋め込み（ベクトル表現）を生成するステップです。",(0,r.jsx)("br",{}),"これにより、意見の内容を数値ベクトルとして表現します。"]}),(0,r.jsx)(p.HStack,{children:(0,r.jsx)(k.Button,{variant:"outline",size:"xs",onClick:()=>i({title:"埋め込み - ".concat(e.step),body:t.config.embedding.source_code}),children:"ソースコード"})})]}),"hierarchical_clustering"===e.step&&(0,r.jsxs)(c,{children:[(0,r.jsx)(u,{fontWeight:"bold",children:"意見グループ化"}),(0,r.jsxs)(h,{children:["埋め込みベクトルの値に基づいて意見の意見グループ化を行うステップです。",(0,r.jsx)("br",{})]}),(0,r.jsx)(p.HStack,{children:(0,r.jsx)(k.Button,{variant:"outline",size:"xs",onClick:()=>i({title:"意見グループ化 - ".concat(e.step),body:t.config.hierarchical_clustering.source_code}),children:"ソースコード"})})]}),"hierarchical_initial_labelling"===e.step&&(0,r.jsxs)(c,{children:[(0,r.jsxs)(u,{fontWeight:"bold",children:["初期ラベリング (",t.config.hierarchical_initial_labelling.model,")"]}),(0,r.jsxs)(h,{children:["意見グループ化の結果に対して、各意見グループに適切なタイトル・説明文を生成（ラベリング）するステップです。",(0,r.jsx)("br",{}),"このステップでは、最も細かい粒度の意見グループ（最下層の意見グループ）に対して、各意見グループに属する意見に基づいて意見グループのタイトルと説明文を生成します。"]}),(0,r.jsxs)(p.HStack,{children:[(0,r.jsx)(k.Button,{variant:"outline",size:"xs",onClick:()=>i({title:"初期ラベリング - ".concat(e.step),body:t.config.hierarchical_initial_labelling.source_code}),children:"ソースコード"}),(0,r.jsx)(k.Button,{variant:"outline",size:"xs",onClick:()=>i({title:"初期ラベリング - ".concat(e.step),body:t.config.hierarchical_initial_labelling.prompt}),children:"プロンプト"})]})]}),"hierarchical_merge_labelling"===e.step&&(0,r.jsxs)(c,{children:[(0,r.jsxs)(u,{fontWeight:"bold",children:["統合ラベリング (",t.config.hierarchical_merge_labelling.model,")"]}),(0,r.jsxs)(h,{children:["意見グループを統合し、統合されたグループのタイトルと説明文を生成（ラベリング）するステップです。",(0,r.jsx)("br",{}),"このステップでは、下層の意見グループのタイトル及び説明文と、意見に基づいて上層の意見グループのタイトル及び説明文を生成します。"]}),(0,r.jsxs)(p.HStack,{children:[(0,r.jsx)(k.Button,{variant:"outline",size:"xs",onClick:()=>i({title:"統合ラベリング - ".concat(e.step),body:t.config.hierarchical_merge_labelling.source_code}),children:"ソースコード"}),(0,r.jsx)(k.Button,{variant:"outline",size:"xs",onClick:()=>i({title:"統合ラベリング - ".concat(e.step),body:t.config.hierarchical_merge_labelling.prompt}),children:"プロンプト"})]})]}),"hierarchical_overview"===e.step&&(0,r.jsxs)(c,{children:[(0,r.jsxs)(u,{fontWeight:"bold",children:["要約 (",t.config.hierarchical_overview.model,")"]}),(0,r.jsxs)(h,{children:["意見グループの概要を作成するステップです。",(0,r.jsx)("br",{}),"各意見グループのタイトル及び説明文をもとに、全体の概要をまとめます。"]}),(0,r.jsxs)(p.HStack,{children:[(0,r.jsx)(k.Button,{variant:"outline",size:"xs",onClick:()=>i({title:"要約 - ".concat(e.step),body:t.config.hierarchical_overview.source_code}),children:"ソースコード"}),(0,r.jsx)(k.Button,{variant:"outline",size:"xs",onClick:()=>i({title:"要約 - ".concat(e.step),body:t.config.hierarchical_overview.prompt}),children:"プロンプト"})]})]}),"hierarchical_aggregation"===e.step&&(0,r.jsxs)(c,{children:[(0,r.jsx)(u,{fontWeight:"bold",children:"出力"}),(0,r.jsxs)(h,{children:["最終的な結果を出力するステップです。",(0,r.jsx)("br",{}),"意見および各分析結果を含むJSONファイルを出力します。"]}),(0,r.jsx)(p.HStack,{children:(0,r.jsx)(k.Button,{variant:"outline",size:"xs",onClick:()=>i({title:"出力 - ".concat(e.step),body:t.config.hierarchical_aggregation.source_code}),children:"ソースコード"})})]}),"hierarchical_visualization"===e.step&&(0,r.jsxs)(c,{children:[(0,r.jsx)(u,{fontWeight:"bold",children:"表示"}),(0,r.jsxs)(h,{children:["出力されたJSONファイルをグラフィカルに表示するステップです。",(0,r.jsx)("br",{}),"意見グループの概要、意見の内容などを可視化します。あなたが見ているこの画面が出来上がります。"]}),(0,r.jsx)(p.HStack,{children:(0,r.jsx)(k.Button,{variant:"outline",size:"xs",onClick:()=>i({title:"表示 - ".concat(e.step),body:t.config.hierarchical_visualization.source_code}),children:"ソースコード"})})]})]},e.step))})})]}),(0,r.jsxs)(n.Kg,{open:!!l,size:"xl",onOpenChange:()=>i(null),children:[(0,r.jsx)(n.ou,{}),(0,r.jsxs)(n.zj,{children:[(0,r.jsx)(n.BE,{children:(0,r.jsx)(n.gk,{children:null==l?void 0:l.title})}),(0,r.jsx)(n.ys,{fontSize:"xs",children:(0,r.jsx)(f.Box,{p:5,borderRadius:5,bgColor:"#111",color:"#fff",whiteSpace:"pre-wrap",className:"code",children:null==l?void 0:l.body})}),(0,r.jsx)(n.tb,{children:(0,r.jsx)(k.Button,{w:"150px",onClick:()=>i(null),children:"閉じる"})})]})]})]})}},59347:(e,t,l)=>{Promise.resolve().then(l.bind(l,27787)),Promise.resolve().then(l.bind(l,67733)),Promise.resolve().then(l.bind(l,49985)),Promise.resolve().then(l.bind(l,6026)),Promise.resolve().then(l.bind(l,24982)),Promise.resolve().then(l.bind(l,99347)),Promise.resolve().then(l.bind(l,54921)),Promise.resolve().then(l.bind(l,92091)),Promise.resolve().then(l.bind(l,21863)),Promise.resolve().then(l.bind(l,68443)),Promise.resolve().then(l.bind(l,55756)),Promise.resolve().then(l.bind(l,48409)),Promise.resolve().then(l.t.bind(l,52619,23))},82180:(e,t,l)=>{"use strict";l.d(t,{m:()=>s});var r=l(95155),n=l(60167),i=l(58579);let s=l(12115).forwardRef(function(e,t){let{showArrow:l,children:s,disabled:a,portalled:o=!0,content:c,contentProps:d,portalRef:u,...h}=e;return a?s:(0,r.jsxs)(n.sb,{...h,children:[(0,r.jsx)(n.k$,{asChild:!0,children:s}),(0,r.jsx)(i.Z,{disabled:!o,container:u,children:(0,r.jsx)(n.ol,{children:(0,r.jsxs)(n.ZI,{ref:t,...d,children:[l&&(0,r.jsx)(n.PR,{children:(0,r.jsx)(n.Mo,{})}),c]})})})]})})}}]);